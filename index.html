<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OTP System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    form {
      max-width: 400px;
      margin: 0 auto;
    }

    input[type="email"],
    input[type="text"],
    input[type="submit"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    input[type="submit"] {
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    input[type="submit"]:hover {
      background-color: #45a049;
    }

    /* Hide OTP input initially */
    #otp-container {
      display: none;
    }
  </style>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js"></script>
</head>
<body>

<!-- Email input container -->
<div id="email-container">
  <form>
    <label for="email">Enter your email:</label><br>
    <input type="email" id="email" name="email" required><br>
    <div id="recaptcha-container"></div> <!-- This div will contain the reCAPTCHA -->
    <input type="button" value="Request OTP" onclick="requestOTP();">
  </form>
</div>

<!-- OTP input container (hidden initially) -->
<div id="otp-container" style="display:none;">
  <form>
    <h3>Enter OTP:</h3>
    <input type="text" id="otp" name="otp" required>
    <input type="submit" value="Validate OTP" onclick="validateOTP();">
  </form>
</div>

<script>
 const firebaseConfig = {
  apiKey: "AIzaSyCobIRZ3KhZwONj51onZO1HosAv_ZZaWqk",
  authDomain: "ahmad-bc991.firebaseapp.com",
  projectId: "ahmad-bc991",
  storageBucket: "ahmad-bc991.appspot.com",
  messagingSenderId: "682986057976",
  appId: "1:682986057976:web:aab8add441986cee864b0d",
  measurementId: "G-81RJ2PBC8Z"
};
  firebase.initializeApp(firebaseConfig);

  function renderRecaptcha() {
    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container');
    recaptchaVerifier.render();
  }

  function requestOTP() {
    const email = document.getElementById("email").value;
    renderRecaptcha(); // Render reCAPTCHA
    
    // Generate OTP (6-digit random number)
    const otp = Math.floor(100000 + Math.random() * 900000);

    // Send OTP via email
    sendOTP(email, otp);

    // Store OTP in sessionStorage for verification
    sessionStorage.setItem("otp", otp);

    // Hide email input and display OTP input
    document.getElementById("email-container").style.display = "none";
    document.getElementById("otp-container").style.display = "block";
  }

  function sendOTP(email, otp) {
    // You can include emojis directly in the email content
    const message = `Your OTP is: ${otp} \nðŸ”’`; // Example including a lock emoji

    // Send email with the OTP
    emailjs.send("service_rxbqsoa", "template_e9vmdgo"", {
      to_email: email,
      message: message // Pass the message containing the OTP
    })
    .then(function(response) {
      console.log("OTP sent successfully", response);
      alert("OTP sent successfully! Please check your email.");
    }, function(error) {
      console.log("Failed to send OTP", error);
      alert("Oops! Something went wrong. Please try again later.");
    });
  }

  function validateOTP() {
    const enteredOTP = document.getElementById("otp").value;
    const storedOTP = sessionStorage.getItem("otp");
    
    if (enteredOTP === storedOTP) {
      alert("OTP validated successfully! You are verified.");
    } else {
      alert("Invalid OTP. Please try again.");
    }
  }
</script>
</body>
</html>
